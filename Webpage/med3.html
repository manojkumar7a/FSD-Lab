<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Premium Medicine Reminder</title>
<style>
* { box-sizing: border-box; font-family: 'Poppins', sans-serif; }

body {
  margin: 0; min-height: 100vh;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  display: flex; justify-content: center; align-items: center;
}

.card {
  width: 480px;
  padding: 30px;
  border-radius: 22px;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(18px);
  border: 1px solid rgba(255,255,255,0.3);
  box-shadow: 0 30px 60px rgba(0,0,0,0.45);
  color: white;
}

h2 { text-align: center; }

label { display: block; margin-top: 12px; font-weight: 500; }

input, select, textarea {
  width: 100%; padding: 9px; margin-top: 5px; border-radius: 8px; border: none;
  background: rgba(255,255,255,0.25); color: white;
}

textarea { resize: none; }

button {
  width: 100%; margin-top: 22px; padding: 12px;
  border-radius: 10px; border: none;
  background: linear-gradient(135deg, #00c6ff, #0072ff);
  color: white; font-size: 16px; cursor: pointer;
}

.status { margin-top: 15px; text-align: center; font-weight: bold; }
</style>
</head>

<body>
<div class="card">
<h2>ðŸ’Š Medicine Reminder</h2>

<label>Patient Name</label>
<input id="patientName">

<label>Age</label>
<input type="number" id="age">

<label>Gender</label>
<select id="gender">
  <option>Male</option>
  <option>Female</option>
  <option>Other</option>
</select>

<label>Mobile Number</label>
<input id="mobile">

<label>Medicine Name</label>
<input id="medicine">

<label>Doctor Name</label>
<input id="doctor">

<label>Dose</label>
<input id="dose">

<label>Start Date</label>
<input type="date" id="startDate">

<label>End Date</label>
<input type="date" id="endDate">

<label>Reminder Time</label>
<input type="time" id="reminderTime">

<label>Description</label>
<textarea id="description" placeholder="Before/After food, once/twice/thrice daily"></textarea>

<button onclick="startReminder()">Set Reminder</button>

<div class="status" id="status"></div>
</div>

<script>
let taken = 0;
let missed = 0;
let reminders = [];
let intervalStarted = false;

// Request notification permission
if (Notification.permission !== "granted") {
  Notification.requestPermission();
}

function startReminder() {
  const medName = document.getElementById("medicine").value;
  const doseVal = document.getElementById("dose").value;
  const timeVal = document.getElementById("reminderTime").value;
  const startDate = document.getElementById("startDate").value;
  const endDate = document.getElementById("endDate").value;

  if (!medName || !timeVal || !startDate || !endDate) {
    alert("Medicine, time, start and end dates are required");
    return;
  }

  // Store reminder
  reminders.push({ medName, doseVal, timeVal, startDate, endDate });

  document.getElementById("status").innerHTML = "â° Reminder is active";

  if (!intervalStarted) {
    intervalStarted = true;
    checkReminders();
  }

  alert("Reminder set successfully!");
}

// Check reminders every second
function checkReminders() {
  setInterval(() => {
    const now = new Date();

    reminders.forEach((reminder) => {
      const today = now.toISOString().split('T')[0];
      if (today < reminder.startDate || today > reminder.endDate) return;

      const [h, m] = reminder.timeVal.split(":");
      if (now.getHours() == h && now.getMinutes() == m && now.getSeconds() === 0) {
        showNotification(reminder.medName, reminder.doseVal);
      }
    });
  }, 1000);
}

function showNotification(medName, dose) {
  const notification = new Notification("ðŸ’Š Medicine Reminder", {
    body: `Time to take ${medName} (${dose})`,
  });

  notification.onclick = () => {
    taken++;
    updateStats();
  };

  // Mark as missed if not clicked in 1 min
  setTimeout(() => {
    missed++;
    updateStats();
  }, 60000);
}

function updateStats() {
  const total = taken + missed;
  const adherence = total ? ((taken / total) * 100).toFixed(1) : 0;
  document.getElementById("status").innerHTML =
    `Taken: ${taken} | Missed: ${missed}<br>Adherence Rate: ${adherence}%`;
}
</script>
</body>
</html>
